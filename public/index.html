<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cryptera APK Detector</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    h1 { color: #333; }
    .section { margin-top: 20px; padding: 10px; background: #fff; border: 1px solid #ddd; border-radius: 4px; }
    .section h2 { font-size: 1.2em; margin-bottom: 5px; }
    .data { margin-left: 20px; }
    button { padding: 8px 16px; font-size: 1em; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Cryptera APK Detector</h1>
  <div>
    <button id="scanBtn">Start Scan</button>
  </div>

  <div class="section">
    <h2>RESULTS</h2>
    <div id="results">No scan yet</div>
  </div>

  <div class="section">
    <h2>Metadata</h2>
    <div class="data" id="metadata">
      <div>Package: —</div>
      <div>Version: —</div>
      <div>Size: —</div>
    </div>
  </div>

  <div class="section">
    <h2>Permission Analysis</h2>
    <div class="data" id="permissionAnalysis">—</div>
  </div>

  <div class="section">
    <h2>Certificate & Signature</h2>
    <div class="data" id="certificateSignature">—</div>
  </div>

  <div class="section">
    <h2>ML Prediction</h2>
    <div class="data" id="mlPrediction">
      <div>Malicious: —</div>
      <div>Legit: —</div>
    </div>
  </div>

  <script>
    document.getElementById("scanBtn").addEventListener("click", function() {
      fetch('/api/details')
        .then(response => response.json())
        .then(data => {
          // Update the Results section
          document.getElementById("results").innerText = data.results;
          // Update the Metadata section
          document.getElementById("metadata").innerHTML = `
            <div>Package: ${data.metadata.package}</div>
            <div>Version: ${data.metadata.version}</div>
            <div>Size: ${data.metadata.size}</div>
          `;
          // Update Permission Analysis section
          document.getElementById("permissionAnalysis").innerText = data.permissionAnalysis;
          // Update Certificate & Signature section
          document.getElementById("certificateSignature").innerText = data.certificateSignature;
          // Update ML Prediction section
          document.getElementById("mlPrediction").innerHTML = `
            <div>Malicious: ${data.mlPrediction.malicious}</div>
            <div>Legit: ${data.mlPrediction.legit}</div>
          `;
        })
        .catch(error => {
          console.error("Error fetching details:", error);
        });
    });
  </script>
</body>
</html>